@using Asistant.Areas.Expert.Models
@model PagedViewModel<RequestViewModel,int>

@{
    ViewData["Title"] = "لیست درخواست‌های موجود";
}
@section Styles {
    <link rel="stylesheet" href="~/css/showrequestforexpert.css" />
}

    <div class="container">

        <div class="page-header">
            <h1 class="page-title">لیست درخواست‌های موجود</h1>
            <div>
                <span>صفحه @Model.PageNumber از @Model.TotalPages</span>
            </div>
        </div>

        <table class="orders-table">
            <thead>
                <tr>
                    <th style="width: 20%;">مشتری / تاریخ</th>
                    <th style="width: 30%;">عنوان و توضیحات</th>
                    <th style="width: 15%;">خدمت / مهارت</th>
                    <th style="width: 15%;">تصاویر</th>
                    <th style="width: 10%;">وضعیت</th>
                    <th style="width: 10%;">عملیات</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Items != null && Model.Items.Any())
                {
                    foreach (var request in Model.Items)
                    {
                        <tr>
                            <td>
                                <div class="customer-info">
                                    <span class="customer-name">@request.CustomerName</span>
                                    <span class="customer-date">@request.CreatedAt</span>
                                    
                                </div>
                            </td>

                            <td>
                                <strong style="display:block; margin-bottom:5px; color:var(--secondary-color);">@request.Title</strong>
                                <p style="margin: 0; font-size: 0.9rem; color: #555; line-height: 1.5;">
                                    @request.Description
                                </p>
                            </td>

                            <td>
                                @if (!string.IsNullOrEmpty(request.HomeServiceName))
                                {
                                   
                                    <span class="service-badge">
                                        @request.HomeServiceName
                                    </span>
                                }
                                else
                                {
                                    <span style="color:#ccc;">-</span>
                                }
                            </td>

                            <td>
                                @if (request.ImagesPath != null && request.ImagesPath.Any())
                                {
                                    <div class="image-gallery">
                                        @foreach (var imgPath in request.ImagesPath)
                                        {
                                            <img src="@imgPath" alt="تصویر" class="thumb-img">
                                        }
                                    </div>
                                }
                                else
                                {
                                    <span style="font-size: 0.8rem; color: #999;">بدون تصویر</span>
                                }
                    </td>

                    <td>
                        <span class="status-badge">
                            @request.Status
                        </span>
                    </td>

                            <td>
                            <a asp-area="Expert"
                               asp-controller="Request"
                               asp-action="ShowDetail"
                               asp-route-requestId="@request.Id">
                                    مشاهده جزییات درخواست
                                </a>
                            </td>
                        </tr>
                                }
                }
                else
                {
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #777;">
                            درخواستی یافت نشد.
                        </td>
                    </tr>
                }
            </tbody>
        </table>

     
        @if (Model.TotalPages > 1)
        {
            <div class="pagination-container">
              
                @if (Model.PageNumber > 1)
                {
                    <a asp-area="Expert" asp-controller="Request"
                    asp-action="ShowRequests"
                    asp-route-pageNumber="@(Model.PageNumber-1)" class="page-link">قبلی</a>
                }
                else
                {
                    <span class="page-link disabled">قبلی</span>
                }

                
                @for (int i = 1; i <= Model.TotalPages; i++)
                {
                    if (i == Model.PageNumber)
                    {
                        <span class="page-link active">@i</span>
                    }
                    else
                    {
                        <a asp-area="Expert" asp-controller="Request"
                    asp-action="ShowRequests"
                    asp-route-pageNumber= "@i" class="page-link">@i</a>
                    }
                }

               
                @if (Model.PageNumber < Model.TotalPages)
                {
                <a asp-area="Expert" asp-controller="Request"
                   asp-action="ShowRequests"
                   asp-route-pageNumber="@(Model.PageNumber + 1)" class="page-link">بعدی</a>
                }
                else
                {
                    <span class="page-link disabled">بعدی</span>
                }
            </div>
        }

    </div>
